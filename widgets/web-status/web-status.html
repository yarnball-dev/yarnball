<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="web-status-styles.html">

<dom-module id="yb-web-status">

  <style include="web-status-styles"></style>

  <template>
    <img class="web-logo" src="web.svg" />
    
    <img class="node-logo" src="node.svg" />
    <div id="nodesCount" class="status-count">N/A</div>
    
    <img class="link-logo" src="link.svg" />
    <div id="linksCount" class="status-count">N/A</div>
  </template>

  <script>
    (function() {
      'use strict';
      
      Polymer({
        is: 'yb-web-status',
        ready: function() {
          this.nodesCount = this.$.nodesCount;
          this.linksCount = this.$.linksCount;
        },
        attached: function() {
          var self = this;
          var parentWebElement = self.getParentWebElement();
          if (parentWebElement) {
            parentWebElement.onInit(function(web) {
              self.nodesCount.textContent = web.getNodeCount();
              self.linksCount.textContent = web.getLinkCount();
              web.onLinks(function() {
                self.nodesCount.textContent = web.getNodeCount();
                self.linksCount.textContent = web.getLinkCount();
              });
            });
          }
        },
        getParentWebElement: function() {
          var parent = this.parentNode;
          while (parent) {
            if (parent.isYbWeb) {
              return parent;
            }
            parent = parent.parentNode;
          }
          return null;
        },
      });
    })();
  </script>

</dom-module>